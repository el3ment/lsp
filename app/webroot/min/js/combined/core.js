/**
 * jQuery Unveil
 * A very lightweight jQuery plugin to lazy load images
 * http://luis-almeida.github.com/unveil
 *
 * Licensed under the MIT license.
 * Copyright 2013 Lu√≠s Almeida
 * https://github.com/luis-almeida
 */

/**
 * Copyright (c) 2010 Maxim Vasiliev
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 *
 * @author Maxim Vasiliev
 * Date: 09.09.2010
 * Time: 19:02:33
 */

(function(){define("utilities/global",["jquery"],function(){window.LSP=window.LSP||{},window.LSP.utilities=window.LSP.utilities||{},$.extend(window.LSP.utilities,function(){var e={},t=window.LSP,n=[],r=[];return e={redirectTo:function(e){document.location=e.replace("www.lonestarpercussion","lspsandbox.explorewebdev")},formatDate:function(e,t){e=typeof e=="string"&&e.indexOf(":")<0?e.replace(/-/g,"/"):e,e=typeof e=="string"?new Date(e):e,e=e||new Date,t=t||"l, F jS Y g:ia";var n="",r={shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],longMonths:["January","February","March","April","May","June","July","August","September","October","November","December"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],longDays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],d:function(e){return(e.getDate()<10?"0":"")+e.getDate()},D:function(e){return this.shortDays[e.getDay()]},j:function(e){return e.getDate()},l:function(e){return this.longDays[e.getDay()]},N:function(e){return e.getDay()+1},S:function(e){return e.getDate()%10==1&&e.getDate()!=11?"st":e.getDate()%10==2&&e.getDate()!=12?"nd":e.getDate()%10==3&&e.getDate()!=13?"rd":"th"},w:function(e){return e.getDay()},z:function(e){var t=new Date(e.getFullYear(),0,1);return Math.ceil((e-t)/864e5)},W:function(e){var t=new Date(e.getFullYear(),0,1);return Math.ceil(((e-t)/864e5+t.getDay()+1)/7)},F:function(e){return this.longMonths[e.getMonth()]},m:function(e){return(e.getMonth()<9?"0":"")+(e.getMonth()+1)},M:function(e){return this.shortMonths[e.getMonth()]},n:function(e){return e.getMonth()+1},t:function(e){var t=new Date;return(new Date(t.getFullYear(),t.getMonth(),0)).getDate()},L:function(e){var t=e.getFullYear();return t%400===0||t%100!==0&&t%4===0},o:function(e){var t=new Date(e.valueOf());return t.setDate(t.getDate()-(e.getDay()+6)%7+3),t.getFullYear()},Y:function(e){return e.getFullYear()},y:function(e){return(""+e.getFullYear()).substr(2)},a:function(e){return e.getHours()<12?"am":"pm"},A:function(e){return e.getHours()<12?"AM":"PM"},B:function(e){return Math.floor(((e.getUTCHours()+1)%24+e.getUTCMinutes()/60+e.getUTCSeconds()/3600)*1e3/24)},g:function(e){return e.getHours()%12||12},G:function(e){return e.getHours()},h:function(e){return((e.getHours()%12||12)<10?"0":"")+(e.getHours()%12||12)},H:function(e){return(e.getHours()<10?"0":"")+e.getHours()},i:function(e){return(e.getMinutes()<10?"0":"")+e.getMinutes()},s:function(e){return(e.getSeconds()<10?"0":"")+e.getSeconds()},u:function(e){var t=e.getMilliseconds();return(t<10?"00":t<100?"0":"")+t},O:function(e){return(-e.getTimezoneOffset()<0?"-":"+")+(Math.abs(e.getTimezoneOffset()/60)<10?"0":"")+Math.abs(e.getTimezoneOffset()/60)+"00"},P:function(e){return(-e.getTimezoneOffset()<0?"-":"+")+(Math.abs(e.getTimezoneOffset()/60)<10?"0":"")+Math.abs(e.getTimezoneOffset()/60)+":00"},T:function(e){var t=e.getMonth();e.setMonth(0);var n=e.toTimeString().replace(/^.+ \(?([^\)]+)\)?$/,"$1");return e.setMonth(t),n},Z:function(e){return-e.getTimezoneOffset()*60},c:function(e){return e.format("Y-m-d\\TH:i:sP")},r:function(e){return e.toString()},U:function(e){return e.getTime()/1e3}};for(var i=0;i<t.length;i++){var s=t.charAt(i);i-1>=0&&t.charAt(i-1)=="\\"?n+=s:r[s]?n+=r[s](e):s!="\\"&&(n+=s)}return n},isEqual:function(e,t){var n=!!e&&!!t;return $.each(e,function(r,i){if(!t.hasOwnProperty(r)&&e[r]+"".length>0||e[r]+""!=e[r]+"")return n=!1,!1}),n&&$.each(t,function(r,i){if(!e.hasOwnProperty(r)&&t[r]+"".length>0||t[r]+""!=e[r]+"")return n=!1,!1}),n},scrollTo:function(e){e=$(e);if(!e)return $.Deferred().resolve();var t=$(window).height(),n=Math.max($("body").scrollTop(),$("html").scrollTop()),r=(e.offset()||{}).top;if(r<n||r>n+t)return LSP.controllers.application.getContext()==="phone"?($("body, html").scrollTop(e.offset().top-20),$.Deferred().resolve()):$("body, html").animate({scrollTop:e.offset().top-20},500)},getURLParameters:function(){var e={},t,n=window.location.href+"#",r=n.slice(n.indexOf("?")+1,n.indexOf("#")).split("&");for(var i=0;i<r.length;i++)t=r[i].split("="),e[t[0]]=decodeURIComponent(t[1]).replace(/\+/g," ");return function(){return e}}(),cleanArray:function(e){for(var t=0;t<e.length;t++)if(e[t]===undefined||(e[t]||"").length<1||e[t]===null||typeof e[t]=="object"&&$.isEmptyObject(e[t]))e.splice(t,1),t--;return e},findBetween:function(e,t,n){var r=n.indexOf(e)+e.length,i=(n+t).indexOf(t,r);return n.substr(r,i-r)},camelCase:function(e){var t=function(e,t){return(t+"").toUpperCase()},n=function(e,t){return(t+"").toLowerCase()};return e.replace(/[^A-Za-z0-9]+/g,"-").replace(/^-ms-/,"ms-").replace(/-([\da-z])/gi,t).replace(/^([A-Z]){1}/,n)},isValid:function(e,t){return LSP.controllers.validation.isValid(e,t)},cleanTrailing:function(e){return(e||"").replace(/^[.\s]+|[.\s]+$/g,"")},parseMicroTemplate:function(){function t(n,r){if(n){var i=/^[A-Za-z]{1}[-:A-Za-z0-9_]+$/.test(n)?e[n]=e[n]||t(document.getElementById(n).innerHTML):new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){var _util=window.LSP.utilities,_controllers=window.LSP.controllers;p.push('"+n.replace(/[\r\t\n]/g," ").replace(/'(?=[^#]*#>)/g,"  ").split("'").join("\\'").split(" ").join("'").replace(/<#=(.+?)#>/g,"',$1,'").split("<#").join("');").split("#>").join("p.push('")+"');}return p.join('');");return r?i.apply(r,[r]):i}return null}var e={};return t}(),parseCurrency:function(e){var t=isNaN(t=Math.abs(t))?2:t,n=n!==undefined?n:"$",r=r||",",i=i||".",s=e<0?"-":"",o=parseInt(e=Math.abs(+e||0).toFixed(t),10)+"",u=(u=o.length)>3?u%3:0;return n+s+(u?o.substr(0,u)+r:"")+o.substr(u).replace(/(\d{3})(?=\d)/g,"$1"+r)+(t?i+Math.abs(e-o).toFixed(t).slice(2):"")},register:function(e,t,n){switch(e){case"model":window.LSP.models=window.LSP.models||{},n.name=t,window.LSP.models[t]=n;break;case"controller":window.LSP.controllers=window.LSP.controllers||{},n.name=t,window.LSP.controllers[t]=n,window.LSP.controllers.application.init(n);break;case"asset":window.LSP.assets=window.LSP.assets||{},n.name=t,window.LSP.assets[t]=n}}},e}())})})(),function(){window.LSP=window.LSP||{},window.LSP.utilities=window.LSP.utilities||{};var e={home:{element:".page-home",js:["controllers/home","plugins/flyout"],priority:"critical"},netsuite:{element:"#handle_loginMainPortlet, #handle_cartMainPortlet",js:["controllers/netsuite","controllers/checkout","vendors/netsuite/interface"],css:["ns-checkout.css"],priority:"critical"},product:{element:'.page-productDetail, .productScope, *[data-controller="product"]',js:["controllers/product"],css:["pages/product.css"],priority:"critical"},search:{element:'input[name="search"], a[href*="search"], *[data-action="destoryAndLoadCategory"]',js:["plugins/search","models/api","models/easyask"],css:["pages/search.css"],priority:document.location.href.indexOf("search")>0?"critical":"secondary"},wishlist:{element:".page-wishlist, .wishlist-messages",js:["controllers/wishlist"],css:["pages/wishlist.css"],priority:document.location.href.indexOf("Wishlist")>0?"critical":"secondary"},categoryBlocks:{element:".categories",css:["components/categoryBlocks.css"],priority:"critical"},cart:{element:"#handle_cartMainPortlet",css:["ns-checkout.css"],priority:"critical"},reviews:{element:".aggregateReviews, .page-generic .reviews",js:["controllers/reviews"],css:["components/reviews.css"],priority:"secondary"},trackOrder:{element:".page-trackOrder",js:["controllers/shipping"],css:["pages/shipping.css"],priority:"critical"},badges:{element:"*[data-badge]",js:["plugins/badges"],css:["components/badges.css"],priority:"secondary"},clearable:{element:".clearable",js:["plugins/clearable"],css:["components/clearable.css"],priority:"secondary"},definitions:{element:"*[data-def]",js:["plugins/definitions"],css:["components/definitions.css"],priority:"secondary"},flyout:{element:".flyout",js:["plugins/flyout"],priority:"secondary"},reveal:{element:"*[data-reveal-children]",js:["plugins/reveal"],css:["components/reveal.css"],priority:"secondary"},suggestions:{element:".dynamicItemSuggestions",js:["plugins/suggestions"],css:["components/dynamicSuggestions.css"],priority:"secondary"},validation:{element:'*[class*="validation-"]',js:["plugins/validation"],priority:"secondary"},zoom:{element:"#zoom-mainImage",js:["vendors/jqzoom/jqzoom"],css:["vendors/jqzoom/jqzoom.css"],priority:"secondary"},ads:{element:'*[class*="bsa-"], .productAd',js:["plugins/ads"],css:["components/ads.css"],priority:"secondary"},category:{element:".page-category",js:["controllers/category"],css:["pages/category.css"],priority:"critical"},schoolCategory:{element:".page-school-category",js:["controllers/category"],css:["pages/school-category.css"],priority:"critical"},checkout:{element:".header.small",js:["controllers/checkout","controllers/netsuite"],css:["ns-checkout.css"],priority:"critical"},touchcarousel:{element:".touchcarousel",js:["vendors/touchcarousel/touchcarousel"],css:["vendors/touch_carousel/touchcarousel.css"],priority:"critical"},byline:{element:".byline",css:["components/byline.css"]}},t=require.toUrl("").indexOf("min")>0;window.LSP.utilities.loader={loadedCSS:[],load:function(n){var r={},i=[];for(var s in e)if(e.hasOwnProperty(s)){var o=e[s];if($(o.element,n).length>0||o.always)o.js&&o.minjs&&(o.js=t?o.minjs:o.js),o.js&&(r[o.priority]=r[o.priority]||[],r[o.priority]=r[o.priority].concat(o.js)),o.css&&(i=i.concat(o.css))}this.loadJS(r),i.length>0},loadJS:function(e,t){require(e.critical||[],function(n){return function(){console.log("Primary loaded",n),$(function(){console.log("Loaded Secondary:",n.secondary),require(n.secondary||[],function(){(t||function(){})()})})}}(e))},getStylesheetUrls:function(){var e=document.getElementsByTagName("link"),t=[];for(var n=0;n<e.length;n++)t.push(e[n].href.replace(/https?\:/,""));return t},loadCSS:function(e){var t=this.getStylesheetUrls(),n="";for(var r=0;r<e.length;r++){e[r].substr(0,1)=="!"&&(e[r]=e[r].replace("!",""),n="https:");var i=n+CDN+"/min/css/"+e[r]+"?v="+VERSION,s=!1;for(var o=0;o<t.length;o++)if(t[o].replace(/https?:/,"")==i.replace(/https?:/,"")){s=!0;break}s||googleAsyncCSSLoader(i)}}},window.LSP.utilities.loader.loadJS({critical:["jquery","combined/core"]}),window.LSP.utilities.loader.loadCSS(["combined/category.css","combined/home.css","combined/product.css","combined/search.css","!ns-checkout.css"])}(),define("utilities/loader",function(){}),define("vendors/unveil/unveil-min",[],function(){(function(e){e.fn.unveil=function(t,n){function f(){var t=u.filter(function(){var t=e(this);if(t.is(":hidden"))return;var n=r.scrollTop(),s=n+r.height(),o=t.offset().top,u=o+t.height();return u>=n-i&&o<=s+i});a=t.trigger("unveil"),u=u.not(a)}var r=e(window),i=t||0,s=window.devicePixelRatio>1,o=s?"data-src-retina":"data-src",u=this,a;return this.attr("src","data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"),this.one("unveil",function(){var t=this.getAttribute(o);t=t||this.getAttribute("data-src"),t&&(this.nodeName==="IMG"?this.setAttribute("src",t):e(this).css("background-image","url("+t+")"),typeof n=="function"&&n.call(this),this.removeAttribute("data-src"),this.removeAttribute("data-src-retina"))}),r.scroll(f),r.resize(f),f(),this}})(window.jQuery||window.Zepto)}),function(){define("controllers/application",["jquery","utilities/loader","utilities/global"],function applicationController(){var _util=window.LSP.utilities,application=function(){var _this={},_app=window.LSP,_assets=_app.assets,_context,_isReadyFired=!1,_hasPushState=!!window.history&&!!history.pushState,_state={},_isPushingState,_defferedScriptCount=0;return _this={events:{application:{onStateChange:function(e,t){$("html").attr("data-path",document.href+"-END")},onResize:function(e,t){var n=$(t.controller?t.controller:_this),r=_context,i=_this.getContext();i!==r&&(console.log("Leaving "+r+" entering "+i),n.triggerHandler("onContextChange",{context:i,previousContext:r}),n.triggerHandler(_util.camelCase("onContextChangeLeave-"+r),{context:i,previousContext:r}),n.triggerHandler(_util.camelCase("onContextChangeEnter-"+i),{context:i,previousContext:r}))},onAttachEvents:function(e,t){console.time("attachEvent : Application"),_util.loader.load(t.selector);var n=[];n=$("*[data-action]",t.selector);for(var r=0;r<n.length;r++){element=$(n[r]);var i=element[0].getAttribute("data-action"),s=element[0].getAttribute("data-controller"),o=!1,u;s||(console.log("Warning :: Loading Parentals - This element needs a data-controller attribute",element),s=element.parents("*[data-controller]:first").data("controller"));switch(element[0].nodeName.toUpperCase()){case"FORM":u="submit.lsp.global",o=!0;break;case"INPUT":case"SELECT":u="change.lsp.global";break;case"BUTTON":o=!0,u="click.lsp.global";break;default:u="click.lsp.global"}s&&i&&element.off(u).on(u,{preventDefault:o,controller:s,action:i,element:element},function(e){console.log("Event : "+e.data.controller+".events."+_util.camelCase("on-"+e.data.action)+" fired."),$(_app.controllers[e.data.controller]).triggerHandler(_util.camelCase("on-"+e.data.action),{selector:e.data.element,originalEvent:e}),e.data.preventDefault&&e.preventDefault()})}require(["vendors/unveil/unveil-min"],function(e){return function(){$("*[data-src]:not([data-lazy-handled])",e.selector).attr("data-lazy-handled",!0).unveil(200)}}(t)),console.timeEnd("attachEvent : Application")},onReady:function(e,data){_isReadyFired=!0,_this.attachEvents($("html")),_this.hasPushState()&&history.replaceState(!0,"page",document.URL);var requestNextScript=function(){var script=$('script[type="text/javascript/defer"]')[0];script&&(script=$(script),script.attr("src")?($.ajaxSetup({cache:!0}),$.getScript(script.attr("src"),function(){requestNextScript()}),script.remove(),$.ajaxSetup({cache:!1})):(eval("with(window){ "+script.html()+"}"),script.remove(),requestNextScript()))};requestNextScript();if(navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)){var viewportmeta=document.querySelector('meta[name="viewport"]');viewportmeta&&(viewportmeta.content="width=device-width, minimum-scale=1.0, maximum-scale=1.0",document.body.addEventListener("gesturestart",function(){viewportmeta.content="width=device-width, minimum-scale=0.25, maximum-scale=1.6"},!1))}},onInit:function(e,t){_state=_this.pullState()}}},assets:{},getContext:function(){var e=$(window).width(),t;return e>=1200?t="largeDesktop":e>979?t="desktop":e>=768?t="tablet":t="phone",_context=t,_context},getFilename:function(){return document.location.pathname.replace(/^.*(\\|\/|\:)/,"")},attachEvents:function(e){$(_this).triggerHandler("onAttachEvents",{selector:e})},createHandlerBridge:function(e,t,n){return function(r){$(e).triggerHandler(_util.camelCase("on-"+t),{selector:this,passthrough:n})}},hasPushState:function(){return _hasPushState},pushState:function(e,t,n){var r=_this.buildStateString(e,t);_this.hasPushState()?(n?(console.log("Replacing State"),history.replaceState(!0,"",("/"+t.path).replace(/\/$/,"")+"/#"+r)):(history.pushState(!0,"",document.location.origin+("/"+t.path).replace(/\/$/,"")+"/#"+r),$("html").attr("data-path",document.location.origin+("/"+t.path).replace(/\/$/,"")+"/#"+r+"-END")),$("html").attr("data-path",document.location.href)):!n&&window.location.hash!=="#"+r&&(_isPushingState=!0,window.location.hash=r)},buildStateString:function(e,t){var n="";return _state[e.name]=t,$.each(_state,function(e,t){n=n+"/~"+encodeURIComponent(e),$.each(t,function(e,t){e!=="path"&&(typeof t=="object"&&t.hasOwnProperty("value")&&t.hasOwnProperty("uriEncode")?t=t.value:typeof t=="object"?t=encodeURIComponent(JSON.stringify(t)):t=encodeURIComponent(t).replace(/%20/g,"+"),t.length>0&&(n+="/"+encodeURIComponent(e)+"/"+t))})}),n},parseStateFromHash:function(e){var t=e.replace(/\?.*/,""),n=t.split("/~"),r={};return $.each(n,function(e,t){var n=t.split("/"),i=n[0];for(var s=1;s<n.length;s+=2){r[i]=r[i]||{},r[i][n[s]]=decodeURIComponent(n[s+1]).replace(/\+/g," ");try{var o=$.parseJSON(r[i][n[s]]);r[i][n[s]]=o}catch(u){}}}),r},pullState:function(e){var t=_this.parseStateFromHash(window.location.hash);return e?t[e.name]:t},_createGlobalEventObject:function(){return eventData={filename:_this.getFilename(),queryParameters:_util.getURLParameters(),context:_this.getContext()},eventData},initializeGlobalEvents:function(){var e=_this._createGlobalEventObject();console.log("initializeGlobalEvents Fired"),$(window).resize(function(){var t;return function(n,r){t&&clearTimeout(t),t=setTimeout(function(){$(_this).triggerHandler("onResize",e)},100)}}()),_this.hasPushState()&&$(window).on("popstate",function(t){history.state&&($(_this).triggerHandler("onStateChange",e),$(_this).triggerHandler("onAfterStateChange",e))}),$(window).on("hashchange",function(t){if(_isPushingState){_isPushingState=!1;return}_isPushingState=!1,e.error=t,$(_this).triggerHandler("onStateChange",e),$(_this).triggerHandler(_util.camelCase("on-"+e.filename+"-state-change"),e)}),$(document).ready(function(n){e.error=n,console.time("Application onRezie, onReady, onAfterReady"),$(_this).triggerHandler("onResize",e),$(_this).triggerHandler("onReady",e),$(_this).triggerHandler("onAfterReady",e),console.timeEnd("Application onRezie, onReady, onAfterReady")})},init:function(e){console.log("Initializing Controller",e),console.time("Initializing Events for "+e.name);var t,n,r,i,s,o;for(t in _app.controllers){s=_app.controllers[t];for(n in s.events){o=_app.controllers[n];for(r in s.events[n])(e&&(e===s||e===o)||!e)&&$(o).bind(r,function(e,t,n){return function(i,s,o,u){console.time("-"+e.name+".events."+t+"."+n),e.events[t][n](i,s,o,u),console.timeEnd("-"+e.name+".events."+t+"."+n)}}(s,n,r))}e===s&&_isReadyFired&&(((s.events||{}).application||{}).onReady&&s.events.application.onReady({},_this._createGlobalEventObject()),((s.events||{}).application||{}).onAfterReady&&s.events.application.onAfterReady({},_this._createGlobalEventObject()),((s.events||{}).application||{}).onAttachEvents&&s.events.application.onAttachEvents({},$.extend({selector:$("html")},_this._createGlobalEventObject())),((s.events||{}).application||{}).onResize&&_this.events.application.onResize({},{controller:s}))}$(e).triggerHandler("onInit"),console.timeEnd("Initializing Events for "+e.name)}},_this}();_util.register("controller","application",application),console.time("Application Initialize"),window.LSP.controllers.application.initializeGlobalEvents()})}(),function(){define("plugins/reveal",["utilities/global","controllers/application"],function(){var e=window.LSP.utilities,t=function(){var e={},t=window.LSP,n=!1,r=300;return e={name:"reveal",events:{reveal:{},application:{onContextChange:function(e,t){$(".reveal-closed-"+t.previousContext).removeClass("reveal-closed").addClass("reveal-open"),$(".reveal-closed-"+t.context).removeClass("reveal-open").addClass("reveal-closed"),$(".reveal-context-"+t.previousContext).removeClass("reveal-open").removeClass("reveal-closed")},onAttachEvents:function(t,n){e.bindEvents(n.selector)}}},assets:{},bindEvents:function(n){$("*[data-reveal-children]",n).off("click.reveal").on("click.reveal",function(t){return e.toggle(e.buildChildrenSelector(this),!$(this).hasClass("reveal-noAnimation")),t.stopPropagation(),!0}),$(".reveal-showOnMouseover",n).off("mouseenter.reveal").on("mouseenter.reveal",function(t){e.toggle(e.buildChildrenSelector(this),!$(t.currentTarget).hasClass("reveal-noAnimation"))}).off("mouseleave.reveal").on("mouseleave.reveal",function(t){e.toggle(e.buildChildrenSelector(this),!$(t.currentTarget).hasClass("reveal-noAnimation"))}),$(".reveal-closed-"+t.controllers.application.getContext()).removeClass("reveal-open").addClass("reveal-closed")},unbindEvents:function(e){$("*[data-reveal-children]",e).off(".reveal")},buildChildrenSelector:function(e){return $("#"+$(e).data("reveal-children").split(" ").join(", #"))},open:function(e,i){if(!n){i=typeof i=="undefined"?!0:i,e.each(function(e,t){$('*[data-reveal-children="'+t.id+'"], *[data-reveal-children*="'+t.id+' "] ').addClass("reveal-open").removeClass("reveal-closed")});if(i&&t.controllers.application.getContext()!=="phone"){var s=$({});e.each(function(e,t){t=$(t),s.queue(function(){var e=$(this);t.css("display","none").addClass("reveal-open").slideDown({duration:r,easing:"swing",complete:function(){t.addClass("reveal-open").css("display","").removeClass("reveal-closed"),e.dequeue()}})})})}else e.addClass("reveal-open").removeClass("reveal-closed")}},close:function(e,i){n=!0,setTimeout(function(){n=!1},50),i=typeof i=="undefined"?!0:i,e.each(function(e,t){$('*[data-reveal-children*="'+t.id+'"] ').addClass("reveal-closed").removeClass("reveal-open")});if(i&&t.controllers.application.getContext()!=="phone"){var s=$({}),e=e.toArray().reverse();$.each(e,function(e,t){s.queue(function(){var e=$(this);$(t).css("display","block").slideUp({duration:r,easing:"swing",complete:function(){$(this).removeClass("reveal-open").addClass("reveal-closed").css("display",""),e.dequeue()}})})})}else e.addClass("reveal-closed").removeClass("reveal-open")},toggle:function(n,r){var i=t.controllers.application.getContext(),s=n.filter('.reveal-open:not(*[class*="reveal-context"]), .reveal-open.reveal-context-'+i),o=n.filter('.reveal-closed:not(*[class*="reveal-context"]), .reveal-closed.reveal-context-'+i+", .reveal-context-"+i+":not(.reveal-open)");e.open(o,r),e.close(s,r)}},e}();e.register("controller","reveal",t)})}(),function(){define("vendors/menu-aim/menu-aim",["jquery"],function(){(function(e){function t(t){var n=e(this),r=null,i=[],s=null,o=null,u=null,a=e.extend({rowSelector:"> li",submenuSelector:"*",submenuDirection:"right",tolerance:75,enter:e.noop,exit:e.noop,activate:e.noop,deactivate:e.noop,exitMenu:e.noop,exitTimeout:0,afterExitMenu:e.noop},t),f=3,l=300,c=function(e){i.push({x:e.pageX,y:e.pageY}),i.length>f&&i.shift()},h=function(){o&&clearTimeout(o),a.exitMenu(this)&&(u=setTimeout(function(){r&&a.deactivate(r),r=null,a.afterExitMenu()},a.exitTimeout))},p=function(){o&&clearTimeout(o),u&&clearTimeout(u),a.enter(this),g(this)},d=function(){a.exit(this)},v=function(){m(this)},m=function(e){if(e==r)return;r&&a.deactivate(r),a.activate(e),r=e},g=function(e){var t=y();t?o=setTimeout(function(){g(e)},t):m(e)},y=function(){function d(e,t){return(t.y-e.y)/(t.x-e.x)}if(!r||!e(r).is(a.submenuSelector))return 0;var t=n.offset(),o={x:t.left,y:t.top-a.tolerance},u={x:t.left+n.outerWidth(),y:o.y},f={x:t.left,y:t.top+n.outerHeight()+a.tolerance},c={x:t.left+n.outerWidth(),y:f.y},h=i[i.length-1],p=i[0];if(!h)return 0;p||(p=h);if(p.x<t.left||p.x>c.x||p.y<t.top||p.y>c.y)return 0;if(s&&h.x==s.x&&h.y==s.y)return 0;var v=u,m=c;a.submenuDirection=="left"?(v=f,m=o):a.submenuDirection=="below"?(v=c,m=f):a.submenuDirection=="above"&&(v=o,m=u);var g=d(h,v),y=d(h,m),b=d(p,v),w=d(p,m);return g<b&&y>w?(s=h,l):(s=null,0)};n.on("mouseleave.menuaim",h).find(a.rowSelector).on("mouseenter.menuaim",p).on("mouseleave.menuaim",d).on("click.menuaim",v),e(document).mousemove(c)}e.fn.menuAim=function(e){return this.each(function(){t.call(this,e)}),this}})(jQuery)})}(),function(){define("plugins/flyout",["utilities/global","controllers/application","plugins/reveal","vendors/menu-aim/menu-aim"],function(){var e=window.LSP.utilities;e.register("controller","flyout",function(){var t={},n=window.LSP,r,i,s,o=!1,u,a=!1,f=!1,o=!1,l=!1,c=!1,h=!1,p,d=n.controllers.reveal,v=150,m=500,g=250;return t={name:"flyout",events:{application:{onContextChangeLeavePhone:function(e,n){t.attachMenu()},onContextChangeEnterPhone:function(e,n){t.detachMenu()},onAfterReady:function(e,r){n.controllers.application.getContext()!=="phone"&&t.attachMenu(),document.location.href.indexOf("netsuite")>0&&t.closeFlyout(!0)}}},assets:{},attachMenu:function(){var e;i=$("#flyoutControlButton"),r=$("#mainFlyout"),s=$("#mainFlyout .topLevel"),d&&d.unbindEvents(s),s.menuAim({activate:t.showRow,deactivate:t.hideRow,exitTimeout:m,exitMenu:function(){return!0},afterExitMenu:function(){o=!1,f=a,clearTimeout(p)}});var n,u;i.off(".flyout").on("mouseenter.lsp.flyout",function(e){!o&&!c&&(u=setTimeout(t.openFlyout,g))}).on("mouseleave.lsp.flyout",function(e){clearTimeout(u)}).on("click.lsp.flyout",function(e){l=!o,c=!l,h=!0,t.toggleFlyout(),c&&setTimeout(function(){c=!1},800)}),$(".topLevel").off(".flyout").on("click.lsp.flyout",function(e){i.click(),e.stopPropagation()}),$(".topLevel li").off(".flyout").on("click.lsp.flyout",function(e){e.stopPropagation()}),$(".container",r).on("mouseenter.lsp.flyout",function(e){clearTimeout(n)}),$(".wrapper",r).on("mouseleave.lsp.flyout",function(e){h||(n=setTimeout(t.closeFlyout,m),clearTimeout(p)),h=!1,e.stopPropagation()}),$(this).triggerHandler("onAfterAttach",{selector:r})},detachMenu:function(){r&&(t.closeFlyout(),$("*",r).off(".menuaim"),i.off(".flyout"),$(".wrapper",r).off(".flyout")),d&&d.bindEvents(s)},openFlyout:function(t){a=t||!1,f=a,o=!0,r&&(r.addClass("active"),i.addClass("active"),e.scrollTo($(".collection:first-child",r)))},closeFlyout:function(e){r?(clearTimeout(p),o=!1,e&&(a=!1,f=!1),a||(r.removeClass("active"),i.removeClass("active"),$("li.collection.active",r).removeClass("active"),u&&$(u.elem).stop(!0,!0),u=null,o=!1)):n.controllers.reveal.close($("#mainFlyout, #mainFlyout *[data-reveal-children]"),!1)},toggleFlyout:function(){o?t.closeFlyout():t.openFlyout()},showRow:function(e,n){if(a&&f&&!n)clearTimeout(p),p=setTimeout(function(){t.showRow(e,!0)},g);else{e=$(e),f=!1;if(!o){var i=$(".flyout",e);if(u)$(u.elem).removeAttr("style"),$(i[0]).css({width:u.now,overflow:"hidden"}),u.elem=i[0];else{var s=i.outerWidth();i.css({width:0}).animate({width:s},{duration:v,easing:"swing",step:function(e,t){u=t},always:function(e){$(".flyout[style]",r).css({width:""}),u=null,o=!0}})}}e.addClass("active"),e.unveil&&$("*[data-src]",e).unveil()}},hideRow:function(e){$(e).removeClass("active")}},t}())})}(),function(){define("models/api",["utilities/global","controllers/application"],function(){var e=window.LSP,t=e.utilities;t.register("model","api",{_timeout:15e3,_url:function(e,t){return""},_payload:function(e,t){return t},_isSuccess:function(e){return(e||{}).success===!0},_afterSuccess:function(e){return e},_request:function(n,r,i,s,o,u){var a=$.Deferred(),f={};return $.support.cors=!0,f.xhrData={type:n,url:this._url(i,o),data:this._payload(i,o),crossDomain:!0,dataType:r,context:this,timeout:this._timeout,passthrough:$.extend({},u)},console.log("API Request Sent via "+s,f.xhrData),$(e.controllers.application).triggerHandler("onBeforeAPICall",f),$(i).triggerHandler("onBeforeAPICall",f),$(i).triggerHandler(t.camelCase("on-Before-API-"+s+"-call"),f),$.ajax(f.xhrData).done(function(e){f.serverResponse=e;try{f.response=$.parseJSON(e)}catch(t){f.response=e}this._isSuccess(e)?(f.response=this._afterSuccess(f.response),a.resolve(f)):(f.error="invalidFormat",a.reject(f))}).fail(function(e){f.serverResponse=e;try{f.response=$.parseJSON(e.responseText)}catch(t){f.response=e}a.reject(f)}).always(function(){console.log("API Response Recieved via "+s,f)}),$.when(a).done(function(n){$(e.controllers.application).triggerHandler("onAfterAPICallSuccess",n),$(i).triggerHandler("onAfterAPICallSuccess",n),$(i).triggerHandler(t.camelCase("on-after-API-"+s+"-success"),n)}).fail(function(n){$(e.controllers.application).triggerHandler("onAfterAPICallFailure",n),$(i).triggerHandler("onAfterAPICallFailure",n),$(i).triggerHandler(t.camelCase("on-after-API-"+s+"-failure"),n)}).always(function(n){$(e.controllers.application).triggerHandler("onAfterAPICall",n),$(i).triggerHandler("onAfterAPICall",n),$(i).triggerHandler(t.camelCase("on-after-API-"+s),n)}),a.promise()},request:function(e,t,n,r){return this._request("GET","jsonp",e,t,n,r)}})})}(),function(){define("models/easyask",["utilities/global","controllers/application","models/api"],function(){var e=window.LSP.utilities,t=window.LSP.models;e.register("model","easyask",function(){var n=$.extend({},t.api),r="nslonestarpercussion",i="http://lonestarpercussion.prod.easyaskondemand.com",s,o={};return $.extend(n,{_timeout:3e4,_url:function(e,t){return i+"/EasyAsk/apps/Advisor.jsp"},_payload:function(t,i){var s={RequestAction:i.action,RequestData:i.method,currentpage:i.page||1,forcepage:1,ResultsPerPage:i.resultsPerPage||24,defsortcols:i.sort==="default"?"":i.sort,indexed:1,rootprods:1,oneshot:1,defarrangeby:"///NONE///",disp:"json",dct:r,q:i.keywords&&i.keywords.length?i.keywords:undefined,AttribSel:n.combineSimilarAttributesForRequest(i.attribute,i.allAttributes)};s.CatPath=e.cleanArray([(i.category||"").replace("All Products",""),n.combineAndRemoveAllForPath(i.attribute,i.allAttributes),this.buildKeywordString(i.keywords)]).join("/").replace(/^\/{1,}-/,"-"),$.isEmptyObject(i.allAttributes)&&!i.attribute&&i.method==="CA_AttributeSelected"&&(s.RequestData="CA_BreadcrumbClick"),s.RequestData==="CA_BreadcrumbRemove"&&!s.q&&!s.AttribSel&&(s.RequestData="CA_CategoryExpand"),s.RequestData!=="CA_Search"&&delete s.q;if(s.ResultsPerPage>96||(s.ResultsPerPage+""||"").toLowerCase()==="all")s.ResultsPerPage=96;return s.CatPath=s.CatPath.replace(/\/$/,"").replace(/^\//,"").replace(/\/\//g,"/"),s},_isSuccess:function(e){return(e||{}).returnCode===0},isRedirect:function(e){return/((http|https)(:\/\/))?([a-zA-Z0-9]+[.]{1}){2}[a-zA-z0-9]+(\/{1}[a-zA-Z0-9]+)*\/?/.test(e.errorMsg)||/^\//.test(e.errorMsg)},_afterSuccess:function(e){if(n.isRedirect(e)){document.location=e.errorMsg;return}s=e.sessionID,e.source=n.clean(e.source),e.source.navPath._lsp=e.source.navPath._lsp||{},e.source.navPath._lsp.categoryNodes=n.getCategoryNodes(e.source),e.source.navPath._lsp.refinementNodes=n.getRefinementNodes(e.source),e.source.navPath._lsp.searchNode=n.getSearchNode(e.source),this.cacheAttributes(e.source),e.source.attributes=e.source.attributes||{},e.source.attributes._lsp=e.source.attributes._lsp||{},e.source.attributes._lsp.cached=n.injectCachedAttributes(e.source),e.source._lsp=e.source._lsp||{},e.source._lsp.query=n.parseCommentaryForDidYouMean(e.source.commentary);for(var t=0;t<((e.source.products||{}).items||{}).length;t++)if(e.source.products.items[t].Matrix_Values){var r=$.parseJSON(e.source.products.items[t].Matrix_Values);e.source.products.items[t]._formattedMatrixObject=n.parseMatrixChildren(r)}return e},clean:function(e){for(var t=0;t<((e.categories||{}).categoryList||[]).length;t++)e.categories.categoryList[t].name==="Schools"&&(e.categories.categoryList.splice(t,1),t--);var n;for(var t=0;t<((e.attributes||{}).attribute||{}).length;t++){for(var r=0;r<(e.attributes.attribute[t].attributeValueList||{}).length;r++){n=e.attributes.attribute[t].attributeValueList[r].attributeValue;if(n.substr(0,1)==="!"||n==="None"||n==="Unknown"||n==="Required")e.attributes.attribute[t].attributeValueList.splice(r,1),r--}for(var r=0;r<(e.attributes.attribute[t].initialAttributeValueList||{}).length;r++){n=e.attributes.attribute[t].initialAttributeValueList[r].attributeValue;if(n.substr(0,1)==="!"||n==="None"||n==="Unknown"||n==="Required")e.attributes.attribute[t].initialAttributeValueList.splice(r,1),e.attributes.attribute[t].initDispLimit--,r--}e.attributes.attribute[t].attributeValueList.length===0&&(e.attributes.attribute.splice(t,1),t--)}return((e.attributes||{}).attribute||[]).length===0&&delete e.attributes,e},combineAndRemoveAllForPath:function(e,t){if(t&&e){var n=e.replace(/:.*/,"");t=t.split("/");for(var r=0;r<t.length;r++)t[r].replace(/:.*/,"")===n&&(t.splice(r,1),r--);return t.join("/")}return t},combineSimilarAttributesForRequest:function(e,t){if(t&&e){var n=e.replace(/:.*/,"");t=t.split("/");for(var r=0;r<t.length;r++)t[r].replace(/:.*/,"")===n&&(e+=";"+t[r]);return e}return e},buildKeywordString:function(e){return e?("-"+e).replace(/-{1,}/,"-"):null},buildSingleAttributeString:function(e){return this.buildMultiAttributeString(e).replace("AttribSelect=","").replace(/\/\/\/\/*/,"")},clearCachedAttributes:function(){o={}},cacheAttributes:function(e){var t={};$.each(o,function(e,t){o[t.attribute.name].isFromCached=!0});for(var n=0;n<((e.attributes||{}).attribute||{}).length;n++){var r=e.attributes.attribute[n];o[r.name]={index:n,attribute:r,isFromCached:!1},t[r.name]=!0}return $.each(o,function(n,r){var i=$(e.navPath.navPathNodeList).last()[0].seoPath,s=r.attribute.attributeValueList[0].nodeString.replace(/:.*/,"");!t[r.attribute.name]&&i.indexOf(s+":")<0&&delete o[r.attribute.name]}),t},injectCachedAttributes:function(e){var t=[],n=[];return $.each(o,function(e,t){n.push(t)}),n.sort(function(e,t){return e.index<t.index?-1:e.index>t.index?1:e.isFromCached&&!t.isFromCached?-1:t.isFromCached&&!e.isFromCached?1:0}),$.each(n,function(n,r){var i=!1;for(var s=0;s<((e.attributes||{}).attribute||{}).length;s++)e.attributes.attribute[s].attributeName===r.attribute.name&&(i=!0,t.push(e.attributes.attribute[s]));i||t.push(r.attribute)}),this.markSelectedAttributes(e,t)},markSelectedAttributes:function(e,t){var t=$.extend(!0,[],t);return $.each(((e.navPath||{})._lsp||{}).refinementNodes,function(e,n){for(var r=0;r<(t||{}).length;r++)if((t[r]||{}).name===n.attribute){for(var e=0;e<(t[r].attributeValueList||{}).length;e++)if(n.value===t[r].attributeValueList[e].attributeValue){t[r].attributeValueList[e].selected=!0;break}break}}),t},getCategoryNodes:function(e){var t=[],n=e.navPath.navPathNodeList,r=this.getCategoriesFromSEOPath(n[n.length-1].seoPath);for(var i=0;i<e.navPath.navPathNodeList.length;i++)if(n[i].navNodePathType===1){n[i].englishName=n[i].englishName.replace(/\/$/,""),n[i].englishName=n[i].englishName==="All-Products"?"All Products":n[i].englishName;if(n[i].englishName!=="All Products"&&n[i].englishName!=="School"){var s=t.push(n[i]),o=t[s-1].seoPath;t[s-1].removePath=r.substr(r.indexOf(o)+o.length,r.length)}}return t},getSearchNode:function(e){for(var t=0;t<e.navPath.navPathNodeList.length;t++)if(e.navPath.navPathNodeList[t].navNodePathType===3)return e.navPath.navPathNodeList[t]},getRefinementNodes:function(t){var n=[];for(var r=0;r<t.navPath.navPathNodeList.length;r++){var i=t.navPath.navPathNodeList[r];if(i.navNodePathType===2){var s=decodeURIComponent(t.navPath.fullPath).replace(/\+/g," "),o=i.englishName.substring(1,i.englishName.length-2);o=o.split("'); (");for(var u=0;u<o.length;u++){var a=o[u].split("' or ");for(var f=0;f<a.length;f++){var l=a[f].split(" = '"),c=this.convertToSEOString(l[0]+":"+l[1]),h=e.findBetween(c,";",i.seoPath);n.push({attribute:l[0],value:l[1],nodeString:c+h})}}}}return n},parseMatrixChildren:function(e){var t={},n={},e=(typeof e=="string"?$.parseJSON(e):e)||[];for(var r=0;r<e.length;r++){var i=e[r][0],s=e[r][1].split("|"),o=s[0],u=s[1],a=s[2],f=s[3],l=s[4],c=s[5],h=s[6],p=s[7];waysToSave=s[8],specialFeature=s[9],t[o]=t[o]||{},t[o][u]=t[o][u]||[],t[o][u].push(i),n[i]=n[i]||{},n[i].options=n[i].options||{},n[i].options[o]=n[i].options[o]||{},n[i].options[o]=u,n[i].data=n[i].data||{},n[i].data.imageUrl=f,n[i].data.mpn=l,n[i].data.onlinePrice=c,n[i].data.msrp=h,n[i].data.stockMessage=p,n[i].data.waysToSave=waysToSave,n[i].data.specialFeature=specialFeature}return{options:t,products:n}},filterMatrixChildren:function(e,t){var n={},r={};return $.each(e.products,function(e,n){for(var i in t)if(t.hasOwnProperty(i)&&n.options[i]&&n.options[i]!=t[i])return;r[e]=n}),$.each(r,function(e,r){$.each(r.options,function(r,i){t[r]||(n[r]=n[r]||{},n[r][i]=n[r][i]||[],n[r][i].push(e))})}),n},convertToSEOString:function(e){return e.replace(/'/g,"").replace(/[^A-Za-z0-9:]/g,"-").replace(/-{1,}/g,"-").replace(/-$/,"").replace(/:-/,":")},getCategoriesFromSEOPath:function(e){var e=e.split("/");for(var t=0;t<e.length;t++)if(e[t].indexOf(":")>0||e[t].indexOf("-")===0)e.splice(t,1),t--;return e.join("/")},getRefinementsFromSEOPath:function(e){var e=e.split("/");for(var t=0;t<e.length;t++)if(e[t].indexOf(":")<0||e[t].indexOf("-")===0)e.splice(t,1),t--;return e.join("/")},getKeywordsFromSEOPath:function(e){var e=unescape(e).split("/");for(var t=0;t<e.length;t++)if(e[t].indexOf("-")===0)return encodeURIComponent(e[t]);return""},parseCommentaryForDidYouMean:function(t){var n={};if(t.length>0&&t.indexOf("Corrected Word")>-1){var r=t.split(" ");n.originalQuery=e.findBetween("Corrected Word: "," is ",t),n.assumedQuery=e.findBetween(" is ","; ",t),n.otherSuggestions=(e.findBetween(" could be  ","~END",t+"~END")||"").split(", ")}return n}})}())})}();var form2js=function(){function e(e,r,i,s,o,u){if(typeof i=="undefined"||i==null)i=!0;if(typeof s=="undefined"||s==null)s=!0;if(typeof r=="undefined"||r==null)r=".";arguments.length<6&&(u=!1),e=typeof e=="string"?document.getElementById(e):e;var a=[],f,l=0;if(e.constructor==Array||typeof NodeList!="undefined"&&e.constructor==NodeList)while(f=e[l++])a=a.concat(n(f,o,u));else a=n(e,o,u);return t(a,i,s,r)}function t(e,t,n,r){var i={},s={},o,u,a,f,l,c,h,p,d,v,m,g,y;for(o=0;o<e.length;o++){l=e[o].value,n&&l===""&&(l=null);if(!(!t||l!==""&&l!==null))continue;g=e[o].name;if(typeof g=="undefined")continue;y=g.split(r),c=[],h=i,p="";for(u=0;u<y.length;u++){m=y[u].split("][");if(m.length>1)for(a=0;a<m.length;a++){a==0?m[a]=m[a]+"]":a==m.length-1?m[a]="["+m[a]:m[a]="["+m[a]+"]",v=m[a].match(/([a-z_]+)?\[([a-z_][a-z0-9_]+?)\]/i);if(v)for(f=1;f<v.length;f++)v[f]&&c.push(v[f]);else c.push(m[a])}else c=c.concat(m)}for(u=0;u<c.length;u++)m=c[u],m.indexOf("[]")>-1&&u==c.length-1?(d=m.substr(0,m.indexOf("[")),p+=d,h[d]||(h[d]=[]),h[d].push(l)):m.indexOf("[")>-1?(d=m.substr(0,m.indexOf("[")),v=m.replace(/(^([a-z_]+)?\[)|(\]$)/gi,""),p+="_"+d+"_"+v,s[p]||(s[p]={}),d!=""&&!h[d]&&(h[d]=[]),u==c.length-1?d==""?(h.push(l),s[p][v]=h[h.length-1]):(h[d].push(l),s[p][v]=h[d][h[d].length-1]):s[p][v]||(/^[a-z_]+\[?/i.test(c[u+1])?h[d].push({}):h[d].push([]),s[p][v]=h[d][h[d].length-1]),h=s[p][v]):(p+=m,u<c.length-1?(h[m]||(h[m]={}),h=h[m]):h[m]=l)}return i}function n(e,t,n){var s=i(e,t,n);return s.length>0?s:r(e,t,n)}function r(e,t,n){var r=[],s=e.firstChild;while(s)r=r.concat(i(s,t,n)),s=s.nextSibling;return r}function i(e,t,n){var i,u,a,f=s(e,n);return i=t&&t(e),i&&i.name?a=[i]:f!=""&&e.nodeName.match(/INPUT|TEXTAREA/i)?(u=o(e),u==null&&e.type=="radio"?a=[]:a=[{name:f,value:u}]):f!=""&&e.nodeName.match(/SELECT/i)?(u=o(e),a=[{name:f.replace(/\[\]$/,""),value:u}]):a=r(e,t,n),a}function s(e,t){return e.name&&e.name!=""?e.name:t&&e.id&&e.id!=""?e.id:""}function o(e){if(e.disabled)return null;switch(e.nodeName){case"TEXTAREA":return $("<div/>").text(e.value).html();case"INPUT":switch(e.type.toLowerCase()){case"radio":case"checkbox":if(e.checked)return e.value;break;case"button":case"reset":case"submit":case"image":return"";default:return e.value}break;case"SELECT":return u(e);default:}return null}function u(e){var t=e.multiple,n=[],r,i,s;if(!t)return e.value;for(r=e.getElementsByTagName("option"),i=0,s=r.length;i<s;i++)r[i].selected&&n.push(r[i].value);return n}return e}();LSP.utilities=LSP.utilities||{},LSP.utilities.formToObject=form2js,define("vendors/form2js/form2js",function(){}),function(){define("plugins/search",["utilities/global","controllers/application","models/api","models/easyask"],function(){var e=window.LSP.utilities;e.register("controller","search",function(){var t={},n=window.LSP,r=n.models.easyask,i=!1,s=!0,o={},u=[],a={};return t={events:{search:{onBeforeAPICall:function(e,t){var n=$("#templates-search-page");if(!n.length)return alert("Unfortunately it appears the templates can't be loaded, please call to complete your order"),_gaq.push(["_trackEvent","search","error","templatesCannotBeLoaded"]),!1;var r=$(".page-generic").height();$(".page-search").addClass("loading")},onAfterAPICall:function(e,t){$(".page-search, .page-generic").removeClass("loading"),$("html").removeClass("search-loading"),s=!1},onAfterAPICallSuccess:function(e,n){if(n.response){var i=n.response.source.navPath.navPathNodeList;o.category=r.getCategoriesFromSEOPath(i[i.length-1].seoPath).replace(/\/$/,""),o.category=o.category.replace(/\/.*\/.*\//,"/"),o.allAttributes=r.getRefinementsFromSEOPath(i[i.length-1].seoPath).replace(/\/$/,""),o.keywords=decodeURIComponent(r.getKeywordsFromSEOPath(i[i.length-1].seoPath).replace(/\-/g," ").replace(/^ /,"")),o.page=((n.response.source.products||{}).itemDescription||{}).currentPage,a=n,$.when(t.scrollToFirst()).done(function(){n.xhrData.passthrough.preventPushState||t.pushState()})}},onAfterAPICallFailure:function(e,n){t.renderFatalError(n)},onRemoveFilter:function(e,n){var r=$(n.selector).data("attribute");$('#refinementForm input[name="'+r+'[]"][value="'+$(n.selector).data("value")+'"]').attr("checked",!1),t.updateHistoryMap(r),t.removeFilterAttribute($(n.selector).data("value"));var i=$(n.selector).data("value").split(":");_gaq.push(["_trackEvent","search","removeFilterAttribute",i[0],i[1]])},onSearch:function(e,n){var r=$('input[name="searchQuery"]',n.selector).trigger("blur").val()||"";if(r.length>0)if(document.location.href.indexOf("https")===-1){$(".mobileSearch .b3").click();if(r!=="undefined"&&r.length||o.keywords&&(o.keywords||{}).length)delete o.category,delete o.allAttributes,s=!1,o.keywords=r,t.search(r)}else document.location="http://www.lonestarpercussion.com/#/~search/keywords/"+encodeURIComponent(r);_gaq.push(["_trackEvent","search","keywordSearch",r])},onRemoveSearch:function(e,n){t.removeSearch(),$('input[name="searchQuery"]').val("").change()},onFilterAttribute:function(e,n){var r=$(n.selector).attr("name").replace("[]","");t.updateHistoryMap(r),$(n.selector).is(":checked")?t.addFilterAttribute($(n.selector).val()):t.removeFilterAttribute($(n.selector).val());var i=$(n.selector).val().split(":");_gaq.push(["_trackEvent","search","filterAttribute",i[0],i[1]])},onClearAllRefinements:function(e,n){u=[],o.allAttributes="",o.keywords="",t.loadCategory(o.category),_gaq.push(["_trackEvent","search","clearAllRefinements",!0])},onLoadCategory:function(e,n){t.loadCategory($(n.selector).data("path"),!0),n.originalEvent.preventDefault(),s=!1,_gaq.push(["_trackEvent","search","filterCategory",$(n.selector).data("path")])},onDestroyAndLoadCategory:function(e,r){s=!1;if(document.location.href.indexOf("https")===-1){var i=($(r.selector).attr("href")+"#").split("#"),o=(n.controllers.application.parseStateFromHash(i[1])||{}).search||{};o.category=o.category||i[0],u=[],t.loadState(o,null,!0)&&($("html").attr("data-path","").addClass("search-loading"),t.scrollToFirst(),n.controllers.flyout.closeFlyout(),r.originalEvent.preventDefault())}_gaq.push(["_trackEvent","search","browseToCategory",o.category])},onRemoveCategory:function(e,n){var r="/"+o.category,i=$(n.selector).data("removepath").split("/");for(var s=0;s<i.length;s++)i[s].length>0&&(r=(r+"/").replace("/"+i[s]+"/","/"));t.loadCategory(r.replace(/\/{1,}/g,"/","/"),!0),_gaq.push(["_trackEvent","search","removeCategory",i])},onNextPage:function(e,n){t.paginate("next"),_gaq.push(["_trackEvent","search","paginate","next"])},onPreviousPage:function(e,n){t.paginate("prev"),_gaq.push(["_trackEvent","search","paginate","previous"])},onSort:function(e,n){o.sort=$(n.selector).val(),t.paginate("first"),_gaq.push(["_trackEvent","search","sort",$(n.selector).val()])},onItemsPerPage:function(e,n){o.resultsPerPage=$(n.selector).val(),t.paginate("first"),_gaq.push(["_trackEvent","search","resultsPerPage",$(n.selector).val()])},onShowCompactView:function(e,n){t.changeView("gridView"),t.pushState(),_gaq.push(["_trackEvent","search","changeView","compact"])},onShowDetailsView:function(e,n){t.changeView("listView"),t.pushState(),_gaq.push(["_trackEvent","search","changeView","detailed"])}},application:{onStateChange:function(e,r){n.controllers.application.pullState(t)?(s=!1,t.loadCurrentState()):s||document.location.reload()},onReady:function(e,r){(n.controllers.application.pullState(t)||((LSP.config||{}).search||{}).loadCurrentState)&&t.loadCurrentState()},onInit:function(e,t){},onContextChangeEnterPhone:function(e,n){t.changeView("listView")}}},assets:{},updateHistoryMap:function(t){require(["vendors/form2js/form2js"],function(){var r=e.formToObject($("#refinementForm")[0]),i=$.grep(u,function(e){return e.name===t}).length;i?u[u.length-1].name!==t&&(u[u.length-1].displayState="static"):u.push({name:t,displayState:"temporary"});for(var s=0;s<u.length-1;s++)u[s].displayState="static";for(var s=0;s<u.length;s++){var o=u[s].name;r[o]||u.splice(s,1)}})},loadCurrentState:function(){t.loadState(n.controllers.application.pullState(t),{preventPushState:!s})},getState:function(){var e=$.extend({},o);return n.controllers.application.hasPushState()&&delete e.category,e.allAttributes={value:(e.allAttributes||"").replace(/[\/]/g,","),uriEncode:!1},e.path=o.category,e.allAttributes.value.length===0&&delete e.allAttributes,e},pushState:function(){var e=t.getState();return n.controllers.application.pushState(t,e,s)},pullState:function(e){var t=document.location.pathname.replace(/\?.*/,""),n={page:"1",view:(LSP.settings||{}).defaultSearchView||"listView"};return o=$.extend({},n,e||{}),o.allAttributes=((o||{}).allAttributes||"").replace(/[\|\,]/g,"/"),t.indexOf(".html")>-1&&!o.category?o.category=t.substring(0,t.lastIndexOf("/")):o.category||(o.category=t),o.category=o.category==="/"?"":o.category,o.category=o.category.replace(/^\//,""),o.category=o.category.replace(/\/$/,""),o.keywords&&(o.keywords=decodeURIComponent(o.keywords).replace(/\-/g," ").replace(/^ /,"")),o},loadState:function(n,r,i){var u=$.extend({},o);return t.pullState(n),$('input[name="searchQuery"]').val(o.keywords),e.isEqual(u,o)?!1:(i&&(s=!1),t.search(null,r),!0)},search:function(e,n){var s={action:"advisor",method:"CA_Search",keywords:e===null?o.keywords:e};return r.request(t,"search",$.extend({},o,{isSingleSelect:i},s),n).done(function(e){e.response&&(((((e.response||{}).source||{}).products||{}).items||[]).length===1&&!((((e.response||{}).source||{})._lsp||{}).query||{}).assumedQuery?document.location.replace(e.serverResponse.source.products.items[0].Item_URL):t.renderPage(e.response.source))})},removeSearch:function(){var e={action:"advisor",method:"CA_BreadcrumbRemove"};return delete o.keywords,r.request(t,"removeSearch",$.extend({},o,{isSingleSelect:i},e)).done(function(e){t.renderPage(e.response.source)})},loadCategory:function(e,n){var s={action:"advisor",method:"CA_CategoryExpand",category:n?e:o.category.replace(/\/$/,"")+"/"+e};return r.request(t,"loadCategory",$.extend({},o,{isSingleSelect:i},s)).done(function(e){t.renderPage(e.response.source)})},addFilterAttribute:function(e){var n={action:"advisor",method:"CA_AttributeSelected",attribute:e};return r.request(t,"filter",$.extend({},o,{isSingleSelect:i},n)).done(function(e){t.renderPage(e.response.source)})},removeFilterAttribute:function(e){var n={action:"advisor",method:"CA_BreadcrumbRemove",allAttributes:o.allAttributes.replace(e,"").replace(";;",";").replace("//","/").replace(/((\/;)|(;\/))/g,"/").replace(/^[\/;]/,"").replace(/[;\/]$/,"")};return r.request(t,"removeFilter",$.extend({},o,{isSingleSelect:i},n)).done(function(e){t.renderPage(e.response.source)})},paginate:function(e){var n={action:"navbar",method:$.isNumeric(e)?"page"+e:e,currentPage:o.page};return r.request(t,"paginate",$.extend({},o,n)).done(function(e){t.renderSummary(e.response.source),t.renderProducts(e.response.source)})},changeView:function(e){if(e==="gridView"||e==="listView")$("#resultsContainer").removeClass("gridView").removeClass("listView").addClass(e),o.view=e,$(".thumbnail img[data-src][data-lazy-handled]").unveil()},renderPage:function(r){if(!$(".page-search").length){$(".page-generic").length||$("#div__body").addClass("page-generic");var i=e.parseMicroTemplate("templates-search-page",{}),s=$.parseHTML(i);$(".page-generic").after(s).hide(),n.controllers.application.attachEvents($(".page-search"))}t.changeView(o.view),$(".page-search").show(),$(".page-generic").hide(),t.renderSummary(r),t.renderSelectedRefinements(r),t.renderRefinements(r),t.renderProducts(r)},scrollToFirst:function(){return e.scrollTo($("body"))},renderSummary:function(t){var r=o.category,i=((t.products||{}).itemDescription||{}).currentPage,s=((t.products||{}).itemDescription||{}).pageCount,u=e.parseMicroTemplate("templates-search-breadcrumbs",$.extend({},t)),a=$("#breadcrumbs").html(u);n.controllers.application.attachEvents(a),a.is(":has(button)")?a.parent(".breadcrumbs").removeClass("hide"):a.parent(".breadcrumbs").addClass("hide");var f=e.parseMicroTemplate("templates-search-title",$.extend({},t));n.controllers.application.attachEvents($("#searchTitle").html(f)),$(".currentPageNumber").html(i),$(".totalPages").html(s),$(".numberOfResults").html(((t.products||{}).itemDescription||{}).totalItems);var l=((t.products||{}).itemDescription||{}).sortOrder||"default";$('select[data-action="sort"]').val(l.indexOf("EAScore")>-1?"default":l),$('select[data-action="itemsPerPage"]').val(((t.products||{}).itemDescription||{}).resultsPerPage),i===1?$('*[data-action="previousPage"]').css("visibility","hidden"):$('*[data-action="previousPage"]').css("visibility","visible"),i===s?$('*[data-action="nextPage"]').css("visibility","hidden"):$('*[data-action="nextPage"]').css("visibility","visible");var c=[];t.navPath._lsp.searchNode&&c.push('"'+t.navPath._lsp.searchNode.englishName+'"');for(var h=t.navPath._lsp.refinementNodes.length-1;h>=0;h--)c.push(t.navPath._lsp.refinementNodes[h].value);document.title=$("#pageName").text()+(c.length?" : "+c.join(", "):"")+" | Lone Star Percussion",$("html").attr("data-title",document.title),_gaq.push(["_trackPageview",o.category+(o.keywords?"/?search="+o.keywords:"")])},renderSelectedRefinements:function(t){var r=e.parseMicroTemplate("templates-search-selectedRefinements",$.extend({},t));n.controllers.application.attachEvents($("#selectedRefinements").html(r))},renderRefinements:function(t){for(var r=0;r<u.length;r++)for(var i=0;i<t.attributes._lsp.cached.length;i++){var s=t.attributes._lsp.cached[i];if((u[r]||{}).name===s.name){t.attributes._lsp.cached[i].displayState=u[r].displayState;break}}var o=e.parseMicroTemplate("templates-search-refinements",$.extend({},t));n.controllers.application.attachEvents($("#searchRefinements").html(o).show()),(t.attributes._lsp.cached||{}).length?$("#searchRefinements").removeClass("empty"):$("#searchRefinements").addClass("empty")},renderProducts:function(r){var i=e.parseMicroTemplate("templates-search-entries",$.extend({},r));n.controllers.application.attachEvents($("#searchEntries").html(i)),t.changeView(o.view)},renderFatalError:function(e){_gaq.push(["_trackEvent","search","error","fatalError : "+e.serverResponse.status+" : "+e.serverResponse.statusText]),receievedMessage=(e.response.errorMsg||"").length>0?" "+e.response.errorMsg+" ":" ",alert("Something has gone wrong with our network connection to our database."+receievedMessage+"Sorry about that!")}},t}())})}(),function(){define("plugins/clearable",["utilities/global","controllers/application"],function(){var e=window.LSP.utilities;e.register("controller","clearable",function(){var e={},t=window.LSP;return e={name:"clearable",events:{clearable:{onClear:function(e,t){$(t.passthrough.targetInput).val(""),$(t.passthrough.targetInput).trigger("change")},onShowHideButton:function(e,t){var n=$(t.passthrough.targetInput);$(t.passthrough.targetInput).val().length>0?n.next("button").fadeIn(200):n.next("button").fadeOut(200)},onSelectedInput:function(e,t){$(t.selector).select()}},application:{onAttachEvents:function(t,n){setTimeout(function(){$(".clearable:not([data-isclearablehandled])",n.selector).each(function(t,n){e.attach(n)}),$('input[type="text"], input[type="number"], input[type="tel"]',n.selector).off("focusable").on("click.lsp.focusable",function(t){$(e).triggerHandler("onSelectedInput",{selector:$(this)})}).change()},200)}}},assets:{},attach:function(n){var r=$('<button type="button" class="b5 clearContents" tabindex="-1">Clear Contents</button>').on("click.lsp.clearable",t.controllers.application.createHandlerBridge(e,"clear",{targetInput:n}));$(n).off("clearable").on("keyup.lsp.clearable change.lsp.clearable",t.controllers.application.createHandlerBridge(e,"showHideButton",{targetInput:n})).wrap('<div class="clearableContainer" />').after(r).attr("data-isclearablehandled",!0)}},e}())})}(),require(["utilities/global","controllers/application","plugins/flyout","plugins/search","plugins/reveal","plugins/clearable"],function(){}),define("combined/core",function(){});
