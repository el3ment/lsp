(function(){define(["jquery","utilities/loader","utilities/global"],function applicationController(){var _util=window.LSP.utilities,application=function(){var _this={},_app=window.LSP,_assets=_app.assets,_context,_isReadyFired=!1,_hasPushState=!!window.history&&!!history.pushState,_state={},_isPushingState,_defferedScriptCount=0;return _this={events:{application:{onStateChange:function(e,t){$("html").attr("data-path",document.href+"-END")},onResize:function(e,t){var n=$(t.controller?t.controller:_this),r=_context,i=_this.getContext();i!==r&&(console.log("Leaving "+r+" entering "+i),n.triggerHandler("onContextChange",{context:i,previousContext:r}),n.triggerHandler(_util.camelCase("onContextChangeLeave-"+r),{context:i,previousContext:r}),n.triggerHandler(_util.camelCase("onContextChangeEnter-"+i),{context:i,previousContext:r}))},onAttachEvents:function(e,t){console.time("attachEvent : Application"),_util.loader.load(t.selector);var n=[];n=$("*[data-action]",t.selector);for(var r=0;r<n.length;r++){element=$(n[r]);var i=element[0].getAttribute("data-action"),s=element[0].getAttribute("data-controller"),o=!1,u;s||(console.log("Warning :: Loading Parentals - This element needs a data-controller attribute",element),s=element.parents("*[data-controller]:first").data("controller"));switch(element[0].nodeName.toUpperCase()){case"FORM":u="submit",o=!0;break;case"INPUT":case"SELECT":u="change";break;case"BUTTON":o=!0,u="click";break;default:u="click"}s&&i&&element.on(u,{preventDefault:o,controller:s,action:i,element:element},function(e){console.log("Event : "+e.data.controller+".events."+_util.camelCase("on-"+e.data.action)+" fired."),$(_app.controllers[e.data.controller]).triggerHandler(_util.camelCase("on-"+e.data.action),{selector:e.data.element,originalEvent:e}),e.data.preventDefault&&e.preventDefault()})}require(["vendors/unveil/unveil-min"],function(e){return function(){$("*[data-src]:not([data-lazy-handled])",e.selector).attr("data-lazy-handled",!0).unveil(200)}}(t)),console.timeEnd("attachEvent : Application")},onReady:function(e,data){_isReadyFired=!0,_this.attachEvents($("html")),_this.hasPushState()&&history.replaceState(!0,"page",document.URL);var requestNextScript=function(){var script=$('script[type="text/javascript/defer"]')[0];script&&(script=$(script),script.attr("src")?($.ajaxSetup({cache:!0}),$.getScript(script.attr("src"),function(){requestNextScript()}),script.remove(),$.ajaxSetup({cache:!1})):(eval("with(window){ "+script.html()+"}"),script.remove(),requestNextScript()))};requestNextScript();if(navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)){var viewportmeta=document.querySelector('meta[name="viewport"]');viewportmeta&&(viewportmeta.content="width=device-width, minimum-scale=1.0, maximum-scale=1.0",document.body.addEventListener("gesturestart",function(){viewportmeta.content="width=device-width, minimum-scale=0.25, maximum-scale=1.6"},!1))}},onInit:function(e,t){_state=_this.pullState()}}},assets:{},getContext:function(){var e=$(window).width(),t;return e>=1200?t="largeDesktop":e>979?t="desktop":e>=768?t="tablet":t="phone",_context=t,_context},getFilename:function(){return document.location.pathname.replace(/^.*(\\|\/|\:)/,"")},attachEvents:function(e){$(_this).triggerHandler("onAttachEvents",{selector:e})},createHandlerBridge:function(e,t,n){return function(r){$(e).triggerHandler(_util.camelCase("on-"+t),{selector:this,passthrough:n})}},hasPushState:function(){return _hasPushState},pushState:function(e,t,n){var r=_this.buildStateString(e,t);_this.hasPushState()?(n?(console.log("Replacing State"),history.replaceState(!0,"",("/"+t.path).replace(/\/$/,"")+"/#"+r)):(history.pushState(!0,"",document.location.origin+("/"+t.path).replace(/\/$/,"")+"/#"+r),$("html").attr("data-path",document.location.origin+("/"+t.path).replace(/\/$/,"")+"/#"+r+"-END")),$("html").attr("data-path",document.location.href)):!n&&window.location.hash!=="#"+r&&(_isPushingState=!0,window.location.hash=r)},buildStateString:function(e,t){var n="";return _state[e.name]=t,$.each(_state,function(e,t){n=n+"/~"+encodeURIComponent(e),$.each(t,function(e,t){e!=="path"&&(typeof t=="object"&&t.hasOwnProperty("value")&&t.hasOwnProperty("uriEncode")?t=t.value:typeof t=="object"?t=encodeURIComponent(JSON.stringify(t)):t=encodeURIComponent(t).replace(/%20/g,"+"),t.length>0&&(n+="/"+encodeURIComponent(e)+"/"+t))})}),n},parseStateFromHash:function(e){var t=e.replace(/\?.*/,""),n=t.split("/~"),r={};return $.each(n,function(e,t){var n=t.split("/"),i=n[0];for(var s=1;s<n.length;s+=2){r[i]=r[i]||{},r[i][n[s]]=decodeURIComponent(n[s+1]).replace(/\+/g," ");try{var o=$.parseJSON(r[i][n[s]]);r[i][n[s]]=o}catch(u){}}}),r},pullState:function(e){var t=_this.parseStateFromHash(window.location.hash);return e?t[e.name]:t},_createGlobalEventObject:function(){return eventData={filename:_this.getFilename(),queryParameters:_util.getURLParameters(),context:_this.getContext()},eventData},initializeGlobalEvents:function(){var e=_this._createGlobalEventObject();$(window).resize(function(){var t;return function(n,r){t&&clearTimeout(t),t=setTimeout(function(){$(_this).triggerHandler("onResize",e)},100)}}()),_this.hasPushState()&&$(window).on("popstate",function(t){history.state&&($(_this).triggerHandler("onStateChange",e),$(_this).triggerHandler("onAfterStateChange",e))}),$(window).on("hashchange",function(t){if(_isPushingState){_isPushingState=!1;return}_isPushingState=!1,e.error=t,$(_this).triggerHandler("onStateChange",e),$(_this).triggerHandler(_util.camelCase("on-"+e.filename+"-state-change"),e)}),$(document).ready(function(t){e.error=t,console.time("Application onRezie, onReady, onAfterReady"),$(_this).triggerHandler("onResize",e),$(_this).triggerHandler("onReady",e),$(_this).triggerHandler("onAfterReady",e),console.timeEnd("Application onRezie, onReady, onAfterReady")})},init:function(e){console.log("Initializing Controller",e),console.time("Initializing Events for "+e.name);var t,n,r,i,s,o;for(t in _app.controllers){s=_app.controllers[t];for(n in s.events){o=_app.controllers[n];for(r in s.events[n])(e&&(e===s||e===o)||!e)&&$(o).bind(r,function(e,t,n){return function(r,i,s,o){e.events[t][n](r,i,s,o)}}(s,n,r))}e===s&&_isReadyFired&&setTimeout(function(){((s.events||{}).application||{}).onReady&&s.events.application.onReady({},_this._createGlobalEventObject()),((s.events||{}).application||{}).onAfterReady&&s.events.application.onAfterReady({},_this._createGlobalEventObject()),((s.events||{}).application||{}).onAttachEvents&&s.events.application.onAttachEvents({},$.extend({selector:$("html")},_this._createGlobalEventObject())),((s.events||{}).application||{}).onResize&&_this.events.application.onResize({},{controller:s})},100)}$(e).triggerHandler("onInit"),console.timeEnd("Initializing Events for "+e.name)}},_this}();_util.register("controller","application",application),console.time("Application Initialize"),window.LSP.controllers.application.initializeGlobalEvents()})})();